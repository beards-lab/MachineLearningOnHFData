rm(list = ls())
library(survival)
library(readxl)
# 从Excel文件加载数据，假设时间列名为 "Time"，事件指示符列名为 "Event"
# 以下是假定的列名，您需替换为您数据的具体列名
data <- read_excel("coxregression.xlsx")
# 创建一个Surv对象，它结合了生存时间和事件发生情况
surv_object <- Surv(time = data$Time, event = data$Event)
cox_model <- coxph(surv_object ~ Aging + SBP + BMI+Sex+Diabetes, data = data)

#查看模型的总结
summary_cox <- summary(cox_model)
print(summary_cox)

# 计算每个变量的危险比 (HR) 和95%置信区间
HR <- exp(coef(cox_model))
CI <- exp(confint(cox_model))

# 打印危险比和置信区间
print(HR)
print(CI)
